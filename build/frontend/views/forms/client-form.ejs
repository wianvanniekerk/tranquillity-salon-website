<%- include('../partials/header', { title: 'Client Skin Analysis Form' }) %>

<div class="bg-gradient-to-br from-teal-50 to-teal-100 min-h-screen py-12">
  <div class="container mx-auto px-4 lg:px-8 max-w-4xl">
    <div class="bg-white rounded-2xl shadow-xl overflow-hidden">
      <div class="px-6 py-8 bg-gradient-to-r from-teal-400 to-teal-500 text-white">
        <h1 class="text-4xl font-extrabold text-center">Client Skin Analysis Form</h1>
        <p class="mt-2 text-center text-teal-50">Please fill out all fields for a comprehensive analysis</p>
      </div>
      <div class="p-8 md:p-12">
        <form id="skinAnalysisForm" action="/forms/submit" method="POST" class="space-y-12">
          <input type="hidden" name="token" value="<%= token %>">
          
          <section>
            <h2 class="text-2xl font-bold text-teal-500 mb-4">General Information</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
              <div class="space-y-4">
                <label for="phoneNumber" class="block text-sm font-semibold text-gray-800">Phone Number</label>
                <input id="phoneNumber" name="phoneNumber" type="text" required class="mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:border-teal-500 focus:ring-teal-500 transition duration-150 ease-in-out bg-gray-200 p-2 text-gray-800">
              </div>

              <div class="space-y-4">
                <label for="occupation" class="block text-sm font-semibold text-gray-800">Occupation</label>
                <input id="occupation" name="occupation" type="text" required class="mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:border-teal-500 focus:ring-teal-500 transition duration-150 ease-in-out bg-gray-200 p-2 text-gray-800">
              </div> 
          
              <div class="space-y-4">
                <label for="address" class="block text-sm font-semibold text-gray-800">Address</label>
                <input id="address" name="address" type="text" required class="mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:border-teal-500 focus:ring-teal-500 transition duration-150 ease-in-out bg-gray-200 p-2 text-gray-800">
              </div>
          
              <div class="space-y-4">
                <label for="area" class="block text-sm font-semibold text-gray-800">Area</label>
                <input id="area" name="area" type="text" required class="mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:border-teal-500 focus:ring-teal-500 transition duration-150 ease-in-out bg-gray-200 p-2 text-gray-800">
              </div>
          
              <div class="space-y-4">
                <label for="postalCode" class="block text-sm font-semibold text-gray-800">Postal Code</label>
                <input id="postalCode" name="postalCode" type="text" required class="mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:border-teal-500 focus:ring-teal-500 transition duration-150 ease-in-out bg-gray-200 p-2 text-gray-800">
              </div>
          
              <div class="space-y-4">
                <label for="dateOfBirth" class="block text-sm font-semibold text-gray-800">Date of Birth</label>
                <input id="dateOfBirth" name="dateOfBirth" type="date" required class="mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:border-teal-500 focus:ring-teal-500 transition duration-150 ease-in-out bg-gray-200 p-2 text-gray-800">
              </div>
          
              <div class="space-y-4">
                <label for="marketingConsent" class="block text-sm font-semibold text-gray-800">Marketing Consent</label>
                <label class="inline-flex items-center">
                  <input type="radio" name="marketingConsent" value="1" required class="form-radio text-teal-500 focus:ring-teal-400">
                  <span class="ml-2 text-gray-800">Yes</span>
                </label>
                <label class="inline-flex items-center">
                  <input type="radio" name="marketingConsent" value="0" required class="form-radio text-teal-500 focus:ring-teal-400">
                  <span class="ml-2 text-gray-800">No</span>
                </label>
              </div>
          
              <div class="space-y-4">
                <label for="idNumber" class="block text-sm font-semibold text-gray-800">ID Number</label>
                <input id="idNumber" name="idNumber" type="text" required autocomplete="off" class="mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:border-teal-500 focus:ring-teal-500 transition duration-150 ease-in-out bg-gray-200 p-2 text-gray-800">
              </div>
          
              <div class="space-y-4">
                <label for="password" class="block text-sm font-semibold text-gray-800">Password</label>
                <input id="password" name="password" type="password" required class="mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:border-teal-500 focus:ring-teal-500 transition duration-150 ease-in-out bg-gray-200 p-2 text-gray-800">
              </div>
            </div>
          </section>          

          <section>
            <h2 class="text-2xl font-bold text-teal-500 mb-4">Skin Information</h2>
            <div class="space-y-4">
              <label for="current_skin_care_range" class="block text-sm font-semibold text-gray-800">Current Skincare Range</label>
              <textarea id="current_skin_care_range" name="current_skin_care_range" rows="3" required class="mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:border-teal-500 focus:ring-teal-500 transition duration-150 ease-in-out bg-gray-200 p-2 text-gray-800"></textarea>
            </div>
          </section>

          <section>
            <h2 class="text-2xl font-bold text-teal-500 mb-4">Medical History</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
              <% const booleanFields = [
                { field: 'HormonalImbalance', label: 'Hormonal Imbalance' },
                { field: 'Pregnant', label: 'Are you Pregnant?' },
                { field: 'Breastfeeding', label: 'Breastfeeding' },
                { field: 'Smoker', label: 'Smoker' },
                { field: 'SkinCancer', label: 'Skin Cancer' },
                { field: 'IPL_Laser_2Weeks', label: 'IPL/Laser in last 2 weeks' },
                { field: 'SkinResurfacing_ChemicalPeels_2Weeks', label: 'Skin Resurfacing/Chemical Peels in last 2 weeks' },
                { field: 'BotoxFillers_2Weeks', label: 'Botox/Fillers in last 2 weeks' },
                { field: 'WaxingElectrolysis_3Days', label: 'Waxing/Electrolysis in last 3 days' }
              ]; %>
              
              <% booleanFields.forEach(item => { %>
                <div class="space-y-2">
                  <label class="block text-sm font-semibold text-gray-800"><%= item.label %></label>
                  <div class="mt-2 space-x-6">
                    <label class="inline-flex items-center">
                      <input type="radio" name="<%= item.field %>" value="1" required class="form-radio text-teal-500 focus:ring-teal-400">
                      <span class="ml-2 text-gray-800">Yes</span>
                    </label>
                    <label class="inline-flex items-center">
                      <input type="radio" name="<%= item.field %>" value="0" required class="form-radio text-teal-500 focus:ring-teal-400">
                      <span class="ml-2 text-gray-800">No</span>
                    </label>
                  </div>
                </div>
              <% }); %>
            </div>

            <div class="mt-8 space-y-4">
              <label for="medical_conditions_surgery_past_year" class="block text-sm font-semibold text-gray-800">Medical Conditions/Surgery in the past year</label>
              <textarea id="medical_conditions_surgery_past_year" name="medical_conditions_surgery_past_year" rows="3" required class="mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:border-teal-500 focus:ring-teal-500 transition duration-150 ease-in-out bg-gray-200 p-2 text-gray-800"></textarea>
            </div>
          </section>

          <section>
            <h2 class="text-2xl font-bold text-teal-500 mb-4">Current Medication Usage</h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
              <% const medicationFields = [
                { field: 'TretinoinMedication', label: 'Tretinoin Medication' },
                { field: 'AccutanesMedication', label: 'Accutane Medication' },
                { field: 'CortisoneMedication', label: 'Cortisone Medication' },
                { field: 'ThyroidMedication', label: 'Thyroid Medication' },
                { field: 'BloodPressureMedication', label: 'Blood Pressure Medication' },
                { field: 'HormonalContraceptives', label: 'Hormonal Contraceptives' }
              ]; %>
              
              <% medicationFields.forEach(item => { %>
                <div class="space-y-2">
                  <label class="block text-sm font-semibold text-gray-800"><%= item.label %></label>
                  <div class="mt-2 space-x-6">
                    <label class="inline-flex items-center">
                      <input type="radio" name="<%= item.field %>" value="1" required class="form-radio text-teal-500 focus:ring-teal-400">
                      <span class="ml-2 text-gray-800">Yes</span>
                    </label>
                    <label class="inline-flex items-center">
                      <input type="radio" name="<%= item.field %>" value="0" required class="form-radio text-teal-500 focus:ring-teal-400">
                      <span class="ml-2 text-gray-800">No</span>
                    </label>
                  </div>
                </div>
              <% }); %>
            </div>

            <div class="mt-8 grid grid-cols-1 md:grid-cols-2 gap-8">
              <div class="space-y-4">
                <label for="other_medications" class="block text-sm font-semibold text-gray-800">Other Medications</label>
                <textarea id="other_medications" name="other_medications" rows="3" required class="mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:border-teal-500 focus:ring-teal-500 transition duration-150 ease-in-out bg-gray-200 p-2 text-gray-800"></textarea>
              </div>

              <div class="space-y-4">
                <label for="allergies" class="block text-sm font-semibold text-gray-800">Allergies</label>
                <textarea id="allergies" name="allergies" rows="3" required class="mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:border-teal-500 focus:ring-teal-500 transition duration-150 ease-in-out bg-gray-200 p-2 text-gray-800"></textarea>
              </div>
            </div>
          </section>

          <div class="flex justify-end">
            <button type="submit" class="inline-flex items-center px-6 py-3 bg-teal-500 text-white font-semibold text-lg rounded-lg shadow-md hover:bg-teal-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500 transition duration-150 ease-in-out">
              Submit Form
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<script>
  document.getElementById('skinAnalysisForm').addEventListener('submit', function(event) {
    const form = event.target;
    const inputs = form.querySelectorAll('input[required], textarea[required]');
    let isValid = true;

    const formData = new FormData(form);
    
    formData.forEach((value, key) => {
        console.log(`${key}: ${value}`);
    });

    inputs.forEach(input => {
      if (input.type === 'radio') {
        const radioGroup = form.querySelectorAll(`input[name="${input.name}"]`);
        const checked = Array.from(radioGroup).some(radio => radio.checked);
        if (!checked) {
          isValid = false;
          const label = input.closest('div').querySelector('label');
          label.classList.add('text-red-500');
        }
      } else if (!input.value.trim()) {
        isValid = false;
        input.classList.add('border-red-500');
      }
    });

    if (!isValid) {
      event.preventDefault();
      alert('Please fill in all required fields.');
    }
  });
</script>

<%- include('../partials/footer') %>
